cgClass.AddClass("Popup",{init:function(e){var o=this,n,q,d,p,m,f,k,s,g,l=$.extend({type:"popup",param:{},title:"",doneText:"确定",cancelText:"取消",popupTemp:null,template:"",message:"",time:null,addClass:"",isLayer:true,isCenter:true,isDrag:true,isOnly:false,autoShow:true,append:{isAppend:false,dom:$(".dom")},hasBtn:true,hasCancel:true,content:null,done:null,cancel:null},e),b=l.content,c=l.done,u=l.cancel,j=typeof l.content=="function"?true:false,h=typeof l.done=="function"?true:false,a=typeof l.cancel=="function"?true:false;o.option=l;o.popup=q=l.popupTemp||$('<div class="module-popup fn-clear Js-popup-wrap"><a href="javascript:void(0)" class="popup-close Js-popup-close"></a> <h6 class="fn-clear popup-tit Js-popup-title">'+l.title+'</h6><div class="popup-con Js-popup-con"></div><div class="popup-btn-wrap Js-popup-btn-wrap"><a class="popup-btn done Js-popup-done" href="javascript:;;"><span class="popup-btn-text">'+l.doneText+'</span></a><a class="popup-btn cancel Js-popup-cancel" href="javascript:;;"><span class="popup-btn-text">'+l.cancelText+"</span></a></div></div>");o.error=f=$('<p class="confirm-msg"></p>');o.template=l.template;o.title=p=q.find(".Js-popup-title");o.btnClose=d=q.find(".Js-popup-close");o.con=m=q.find(".Js-popup-con");o.btnWrap=k=q.find(".Js-popup-btn-wrap");o.btnDone=s=k.find(".Js-popup-done");o.btnCancel=g=k.find(".Js-popup-cancel");o.outParam=o.applyMethods(o,{param:l.param,oPopup:q,oCon:m,oBtnWrap:k,oBtnDone:s,oBtnCancel:g,oBtnClose:d,oLayer:n,show:o.show,hide:o.hide,close:o.close,reset:o.reset,showTip:o.showTip,removeTip:o.removeTip,disableBtn:o.disableBtn});switch(l.type){case"popup":break;case"confirm":if(!l.message){return false}l.title=l.title||"提示";o.template='<p class="confirm-msg">'+l.message+"</p>";if(h){l.done=function(){c(o.outParam);o.close()}}break;case"result":if(!l.message){return false}l.title=l.title||"提示";if(typeof l.message=="string"){o.template='<p class="confirm-msg">'+l.message+"</p>"}if(l.message.constructor==Array&&l.message.length){var t="";for(var r=0;r<l.message.length;r++){t+='<p class="confirm-error-msg">'+l.message[r]+"</p>"}o.template=t}l.hasCancel=false;if(!!l.time){if(j){b(o.outParam)}l.content=function(){setTimeout(function(){o.close()},l.time)}}break;default:break}if(!l.title){p.hide()}if(l.isLayer){o.layer=n=$("<div class='module-popup-layer'></div>");$("body").append(n)}if(l.isOnly){$(".module-popup-layer").remove();$(".Js-popup-wrap").remove()}if(l.append.isAppend){l.append.dom.append(q)}else{$("body").append(q)}if(l.addClass){q.addClass(l.addClass)}m.append(o.template);if(typeof(l.content)=="function"){l.content(o.outParam)}q.on("click",".Js-popup-close",function(){if(l.hasCancel&&a){l.cancel(o.outParam)}else{if(!l.hasCancel&&h){l.done(o.outParam)}o.close()}}).on("click",".Js-popup-done",function(){if(l.hasBtn&&!$(this).hasClass("popup-btn-disabled")&&h){o.disableBtn();l.done(o.outParam)}if(!h){o.close()}return false}).on("click",".Js-popup-cancel",function(){if(a){l.cancel(o.outParam)}else{o.close()}});if(l.isDrag){o.bindDrag()}if(l.hasBtn){if(!l.hasCancel){g.remove()}}else{k.remove()}if(l.isCenter&&!l.append.isAppend){$(window).resize(function(){o.positionCenter()})}if(l.autoShow){o.show()}},bindDrag:function(){var a=this,b={};a.title.css("cursor","move");a.popup.on("mousedown",".Js-popup-title",function(d){d.preventDefault();var c=a.popup.position();b.posLeft=c.left;b.posTop=c.top;b.dl=d.pageX;b.dt=d.pageY;$(document).on("mousemove",function(f){f.preventDefault();b.ml=f.pageX;b.mt=f.pageY;b.ol=b.posLeft+b.ml-b.dl;b.ot=b.posTop+b.mt-b.dt;a.popup.css({left:b.ol+"px",top:b.ot+"px"})});$(document).one("mouseup",function(){$(document).off("mousemove")})})},positionCenter:function(){var b=this,c=b.popup.width(),a=b.popup.height();b.popup.css({position:"fixed",top:"40%",left:"50%",margin:"-"+a/2+"px 0 0 -"+c/2+"px"})},show:function(b){var a=this;a.positionCenter();if(a.option.isLayer){a.layer.show()}a.popup.show();if(Modernizr.csstransitions){a.popup.addClass("fadeInDown").delay(800).show(0,function(){$(this).removeClass("fadeInDown")})}if(typeof b=="function"){b(a.outParam)}},hide:function(b){var a=this;if(a.option.isLayer){a.layer.hide()}if(!Modernizr.csstransitions){a.popup.hide()}else{a.popup.addClass("fadeOutUp").delay(800).hide(0,function(){$(this).removeClass("fadeOutUp")})}if(typeof b=="function"){b(a.outParam)}},close:function(b){var a=this;if(a.option.isLayer){a.layer.remove()}if(!Modernizr.csstransitions){a.popup.remove()}else{a.popup.addClass("fadeOutUp").delay(700).hide(0,function(){a.popup.remove()})}if(typeof b=="function"){b(a.outParam)}},showTip:function(b){var a=this;a.popup.addClass("rock").delay(500).show("0",function(){$(this).removeClass("rock");a.disableBtn(true)});if(!a.con.find(a.error).length){a.con.append(a.error)}a.error.show().html(b)},removeTip:function(){this.error.hide()},reset:function(b){var a=this;if(!!b){a.con.html(b)}else{a.con.html(a.template)}},disableBtn:function(b){var a=this;if(b){a.btnDone.removeClass("popup-btn-disabled")}else{a.btnDone.addClass("popup-btn-disabled")}}});